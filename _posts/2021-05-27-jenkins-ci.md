---
title: "빌드와 단위 테스트 자동화를 위한 Jenkins CI 도입"
excerpt: "Jenkins, CI, Agile"
comments: true

categories:
  - Project
last_modified_at: 2021-06-22
---
## 효율적으로 일한다는 건
처음 개발을 시작했을 때는 혼자만의 기술 지식과 코딩 능력에만 집중했었습니다. 최대한 빠른 시간 내에 동작하는 함수를 만들어 내 업무 할당량을 마무리 짓는 걸 우선 사항으로 여기기도 했습니다. 그러다 지인 분의 추천으로 산드로 만쿠소가 쓴 소프트웨어 장인이라는 책을 읽으면서 개발은 단순 코딩이 아닌 전체적인 개발 주기 관리와 발전에 의거함을 보여줍니다.

개발의 전체 프로세스를 소프트웨어 개발 생명주기라고 하며 계획부터 개발, 테스트, 배포, 후 유지 보수까지 전체 과정을 의미합니다. 제가 처음 중요하게 여겼던 개발 과정은 전체 프로세스의 일부분에 지나지 않습니다. 이 전체 과정을 불필요한 시간 낭비 없이 효율적으로 움직일 수 있는 게 이상적인 업무 방법입니다.

개발자들도 이런 중요성을 인지하고 더 나은 방법을 연구해왔습니다. 여러 방식 중 오랫동안 사용된 폭포수 모델이 있습니다. 변경 횟수가 적은 계획엔 효과적이지만 최근 고객의 요구 사항이 잦고 산업이 빠르게 변화되는 만큼 즉각적인 대처가 가능한 모델의 필요성이 대두되고 있습니다. 각광 받는 모델은 만쿠소의 책에서도 소개됐던 에자일 모델이 있습니다.

<br>

## 폭포수 모델 vs 에자일 모델
폭포수 모델은 기획, 개발, 테스트, 배포 단계를 순서대로 거치는 단방향 프로세스를 의미합니다. 단계의 범위는 전체 애플리케이션을 기준으로 돌아갑니다. 각 단계마다 걸리는 시간이 길기 때문에 기획 단계에서 의도치 않은 변경이 생기지 않도록 구조를 짜야 합니다. 

에자일 모델은 범위를 전체 애플리케이션이 아닌 한 기능을 기준으로 진행합니다. 네이버에 나온 정의에 의하면 정해진 계획이 아닌 개발 주기 또는 소프트웨어 환경에 유연하게 대처합니다. 그러기에 실행 가능한 기능을 바로 고객에게 넘겨 받은 피드백을 기능에 바로 반영할 수 있다는 장점이 있습니다.\

![Untitled (1)](https://user-images.githubusercontent.com/71559880/122907878-867ba900-d38e-11eb-8dc4-a7b63719c0a9.png)

<br>

에자일 개발 방식을 회사 문화로 정착 시키려면 잦은 커밋에도 에러 없이 동작하며, 기능을 구분해 확장성과 독립성을 부여할 수 있는 환경이 구성되야 합니다. 이를 위해 많은 회사에서 CI를 적용합니다.

<br>

## CI(Continuous Integration)
직역하면 지속적인 통합으로, 팀의 통합 프로젝트에 개인이 작업했던 코드 내용을 합치는 과정으로 위에서 언급한 에자일 모델에 적합한 방식입니다. CI를 위한 여러 툴이 존재하지만 저는 Jenkins를 사용하기로 했습니다.

<br>

## Jenkins
지속적인 통합을 위한 소프트웨어 도구입니다. Jenkins는 CI와 CD(Continuous Deployment)에서 자주 언급되는 툴입니다. Jenkins를 이용하면 CI 과정을 자동화 할 수 있기에 개발자는 개발에 더 신경을 쓸 수 있다는 장점이 있습니다. 

원래대로라면 매 커밋마다 프로젝트 빌드, 단위 테스트, jar 파일 생성 과정을 개발자가 직접 해줘야 합니다. 굉장히 지루한 작업이기도 하지만 중간에 개발자의 실수로 에러가 생길 가능성도 배제할 수 없습니다. 그렇기에 Jenkins로 에러 없는 방식으로 자동화를 설정하면 전체 개발 주기에 시간을 단축시키고 로직 작업에 더 집중할 수 있습니다.

<br>

## 적용
제가 하는 프로젝트는 GitHub에서 기능을 브랜치 별로 분리 및 관리하고 작성이 끝난 feature 브랜치를 개발 메인 브랜치인 main에 머지하는 형식입니다. 여기서 자동화 할 부분은 원격 리포지토리로 push를 했을 때, GitHub는 Jenkins로 새로 작성된 코드가 추가된 애플리케이션을 보내 빌드, 테스트, 파일 생성까지 완성시킵니다.

그렇다면 제가 구현할 부분은 젠킨스 설치, 형상관리 툴과 연결, 자동화 및 기능 확인으로 이어집니다.

저는 우선 젠킨스를 새로운 서버에 설치해 운영하기로 했습니다. 클라우드 서비스에서 서버를 하나 생성합니다. 제가 사용한 서버는 우분투 16.04입니다. 

젠킨스를 사용하려면 자바를 설치해줘야 합니다. 제 경우 우분투 16.04에서 젠킨스를 사용할 때 자바 11 버전이 에러를 많이 일으켜서 8버전을 명시해 설치했습니다.

```
sudo apt-get update // 설치 전 우분투 서버 업데이트
sudo apt-get install openjdk-8-jdk
java -version // 설치한 자바 버전 확인

update-java-alternatives -l // JAVA_HOME의 path를 알기 위한 명령어
java-1.8.0-openjdk-amd64 1081 /usr/lib/jvm/java-1.8.0-openjdk-amd64 // 위 명령어로 나오는 결과. /usr부터 경로를 복사

sudo nano /etc/environment // 환경 파일 edit하기 위한 명령어
JAVA_HOME="/usr/lib/jvm/java-1.8.0-openjdk-amd64" // 해당 라인 작성하고 저장
```

<br>

그 다음에 젠킨스를 설치합니다.

```
wget --no-check-certificate -q -O - https://pkg.jenkins.io/debian-stable/jenkins-ci.org.key | sudo apt-key add -

echo deb http://pkg.jenkins.io/debian-stable binary/ | sudo tee /etc/apt/sources.list.d/jenkins.list
```

<br>

설치가 끝나면 해당 서버의 ip 주소와 기본 포트인 8080을 url에 입력하면 젠킨스 메인 화면이 나옵니다.

그러면 아이디와 패스워드를 생성하면 본인 만의 젠킨스를 갖게 됩니다.

그 다음은 만든 젠킨스와 GitHub의 프로젝트를 연결시켜야 합니다.

연결 방법으로는 web hook이 있으며 엑세스 허용을 위한 토큰을 생성해 구분하는 역할입니다.

<br>

## 출처
Learing Continous Integration with Jenkins 2nd Edition

